---
status: "proposed"
date: "2025-10-07"
decision-makers: Fernando Paris [fernando.paris@swirldslabs.com](mailto:fernando.paris@swirldslabs.com), Mariusz Jasuwienas [mariusz.jasuwienas@arianelabs.com](mailto:mariusz.jasuwienas@arianelabs.com), Michal Walczak [michal.walczak@arianelabs.com](mailto:michal.walczak@arianelabs.com), Piotr Swierzy [piotr.swierzy@arianelabs.com](mailto:piotr.swierzy@arianelabs.com)
consulted:
informed:
---

# ADR 005: Automate documentation generation for System Contracts

## Context and problem statement

Currently, the **System Contracts interfaces** (e.g., `IHederaTokenService`) contain limited inline documentation - typically only a brief summary per method.
This creates friction for developers trying to understand how these contracts map to **system contract calls**.

Manually maintaining the documentation is time-consuming.
Consensus node's code still evolves so it may become outdated again.
To ensure accuracy and consistency, we should **automatically generate documentation** for these interfaces based on canonical **protobuf definitions** and **consensus node specifications** located in the `.proto` files in the [hiero-consensus-node](https://github.com/hiero-ledger/hiero-consensus-node) repository.

> WARNING! Unfortunately currently, only the gRPC API interface is well-documented; precompiles and their mappings are not documented at all. Only the services executed when a precompile address with a certain selector is called are documented as well.

## Decision Drivers

* Maintain 1:1 consistency between Solidity interfaces and consensus node code
* Reduce manual maintenance and update burden
* Improve developer experience thanks to the richer and more accurate docs
* Support auto-generation of Markdown and NatSpec for use in IDEs and NPM docs

## Considered options

1. Use [`protoc-gen-p6`](https://github.com/layotto/protoc-gen-p6) or [`protoc-gen-doc`](https://github.com/pseudomuto/protoc-gen-doc)
2. **Write a Custom Documentation Generator** (recommended)
3. Use the Solidity files from the Hedera Consensus Node repository and make sure they are always well-documented
4. One time semi-automatic documentation generation - worry about keeping it up to date later

## Option 1: Use [`protoc-gen-p6`](https://github.com/layotto/protoc-gen-p6) or [`protoc-gen-doc`](https://github.com/pseudomuto/protoc-gen-doc)

These are `protoc` plugins that generate documentation and metadata from `.proto` files, supporting structured output formats (Markdown, JSON, HTML, etc.).
We could use them to generate Markdown files describing our System Contracts and store them directly in our documentation directory.

### Positive

* Enables easy conversion of protobuf files into Markdown or HTML documentation.
* Minimal setup effort, leveraging existing open-source tooling.

### Negative

* Protobuf files in the consensus node repository do not strictly match the interfaces of the precompiles.
* We would need to **map the `TransactionBody` protobuf definitions** describing actual calls into the corresponding **smart contract methods** before the output becomes useful.
* Limited flexibility to customize documentation for Solidity - specific details.

## Option 2: Write a custom documentation generator

Develop an internal tool to directly parse protobuf definitions and generate documentation artifacts such as:

* Solidity docstrings (NatSpec format)
* Markdown developer documentation

This tool could leverage `protobufjs` (TypeScript) to parse definitions and render output using templates.

### Positive

* The initial PoC was already prepared during the verification process, so we know it’s possible.
* Full control over mapping logic and formatting.
* Enables defining a clear mapping between Java transaction interfaces and Solidity method signatures - which would be necessary in other approaches as well.
* Final output can be generated in multiple formats (both: NatSpec and Markdown), not limited to a specific format.

### Negative

* Slightly higher initial development cost.
* Requires defining and maintaining a mapping layer between protobuf and Solidity interfaces.

## Option 3: Use the solidity files from the Hedera consensus node repository

Since the functionality and behavior of precompiles depend directly on how the code is implemented in the consensus node repository,
it might make sense for the **canonical and up-to-date documentation** to live there.

This repository already exposes internal services and example precompile interfaces that are similar to those in the `hedera-smart-contracts` repository but often more up to date.

### Positive

* Simplest solution - minimal new work required.
* Documentation responsibility could be shifted to the repository that directly implements the precompiles.
* Developers could be redirected to view the code and documentation in the consensus node repository for better references.

### Negative

* Requires discipline and additional effort from the team maintaining the consensus node code.
* Less control from the System Contracts repository over the documentation format and availability.

## Option 4: One-time semi-automatic documentation generation

Generate the documentation **once**, using a semi-automated approach (for example, by combining `protoc` output, manual editing, and scripted Markdown generation), and defer automation of updates until later.
This would allow us to quickly produce an initial set of documentation for all System Contracts without committing to a fully automated pipeline yet.

### Positive

* **Fast initial delivery** - produces usable documentation quickly with minimal setup.
* **Low implementation effort** - can use existing tools and scripts without developing or integrating a new generator.
* **Good starting point** - provides a baseline that can be iteratively improved or automated later.

### Negative

* **Documentation will quickly become outdated** as protobufs or node interfaces evolve.
* **Requires manual updates** in future releases, risking inconsistencies between code and docs.
* **No long-term scalability** - effectively a temporary solution that delays the need for full automation.

## Decision Outcome

**Chosen Option (Recommended):** **Option 2 — Build an Internal Generator**

### Rationale

While existing plugins like `protoc-gen-p6` and `protoc-gen-doc` provide a solid foundation, they lack the flexibility to fully express the mapping between **Hedera Services** and **Precompile Interfaces**.
A custom tool provides complete control over this mapping, output format, and future extensibility.

## Implementation notes

* Integration point: `npm run generate-docs` in the System Contracts repository.
* Output formats:
    * Solidity NatSpec comments
    * Markdown developer documentation
* Potential tech stack:
    * **Parser:** `protobufjs` (TypeScript)
* The generator could optionally consume the `.proto` files directly from the `hiero-consensus-node` repository.

## Final decision

We propose implementing a **custom documentation generation pipeline**, inspired by (but not limited to) existing tools (`protoc-gen-p6`, `protoc-gen-doc`), purpose-built for **Hedera System Contracts**.
This will automate the documentation generation and synchronization process.
