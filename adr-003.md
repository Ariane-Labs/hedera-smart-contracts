---
status: "proposed"
date: "2025-10-06"
decision-makers: Fernano Paris <fernando.paris@swirldslabs.com>, Mariusz Jasuwienas <mariusz.jasuwienas@arianelabs.com>, Michal Walczak <michal.walczak@arianelabs.com>, Piotr Swierzy <piotr.swierzy@arianelabs.com>
consulted:
informed:
---

# ADR 003: Include Tests and Examples in System Contracts Repository

## Context and Problem Statement

The new Hedera System Contracts repository will be published as an NPM package for developers to use. We need to decide whether to include tests and examples in the repository, and if so, how to handle them in the published package.

The key tension is between:
- Maintaining high code quality through comprehensive tests
- Providing executable documentation and usage examples
- Keeping the published NPM package lean and focused

## Decision Drivers

- Quality and reliability of the library (tests as a verification mechanism)
- Developer experience and ability to understand contract usage
- NPM package size and cleanliness
- Repository maintainability
- Providing reference implementations and usage patterns

## Considered Options

1. Remove Tests and Examples from the Repository
2. Keep Tests and Examples in Repository, Exclude from NPM Package
3. **Keep Hardhat tests in Repository, but exclude Examples from the contracts directory** (recommended)

### Option 1: Remove Tests and Examples from the Repository

The repository contains only production-ready smart contracts, with no tests or examples included.

## Consequences

### Positive

- Clean, focused repository containing only production code
- Minimal maintenance overhead
- Clear purpose - no ambiguity about what's production-ready
- Smaller repository size and faster clones
- NPM package contains exactly what's in the repository
- Simpler CI/CD (no test execution in this repo)
- Forces clear separation between library and examples
- Similar approach to some mature libraries that rely on community validation

### Negative

- Contributors cannot run tests directly in the repository
- Higher barrier for external contributions (harder to validate changes)
- Need to maintain testing infrastructure elsewhere
- Less confidence for contributors that changes don't break functionality
- Examples are not co-located with contracts
- Need clear documentation about where to find tests and examples
- Potential quality concerns without built-in validation

## Option 2: Keep Tests and Examples in Repository, Exclude from NPM Package

The repository contains tests and examples, but they are excluded from the published NPM package via `.npmignore`.

## Consequences

### Positive

- High code quality maintained through comprehensive tests
- Better developer experience with clear, executable examples
- Executable documentation helps users understand contract usage
- Contributors can validate their changes before submitting PRs
- Clean NPM package without test code or build artifacts
- Lower barrier to entry for new contributors
- Tests serve as both verification and documentation
- All related code in one place

### Negative

- Repository is larger due to test code
- Need to maintain tests alongside production code
- Must ensure `.npmignore` is properly configured
- More complex CI/CD pipeline
- Increased maintenance burden
- Risk of tests becoming outdated
- Need to support testing frameworks (see ADR-005)

### Option 3: Include Hedera Tests and exclude Examples in the NPM Package

In this option, the repository keeps all Hardhat tests, and the published NPM package intentionally includes these tests so consumers can run them locally. All "example" contracts and walkthrough projects are excluded from both the contracts directory and the NPM package to keep the public API clear. The package ships production contracts plus reference tests; examples live in a separate repo or docs site.

## Consequences

### Positive

- Tests act as an executable specification shipped with the library, enabling users to validate their environment and integration quickly.
- Improves downstream confidence and compatibility checks; consumers can run the same suite the maintainers use.
- Facilitates security reviews and audits by providing ready-to-run behavioral coverage next to the artifacts.
- Reduces ambiguity around expected behaviors and edge cases by documenting them in code.
- Helpful for SDK, tooling, and plugin authors who need concrete test vectors and fixtures.
- Can accelerate bug reproduction for external reporters (share failing test against a released version).
- Encourages contributions that come with failing/passing tests aligned to a released package version.

### Negative

- Significantly increases NPM package size due to tests, fixtures, and snapshots, impacting install times and network usage.
- Blurs the separation between runtime dependencies and dev/test-only dependencies; may require promoting some devDeps to regular deps so tests run after install.
- Potential security and IP exposure risks by shipping internal testing utilities, mocks, or data.
- Higher maintenance burden to keep shipped tests always green across environments and Node/Hardhat versions used by consumers.
- Risk of user confusion (tests in node_modules) and accidental execution in production CI pipelines.
- Harder versioning constraints: changing tests in a patch/minor can be a breaking change for consumers who rely on them.
- CI for the package must ensure tests are shippable and executable post-install, adding complexity.

## Decision Outcome

**Chosen option:** Keep Hardhat tests in Repository, but exclude Examples from the contracts directory.

### Rationale

This option best balances quality, developer experience, and package cleanliness. Keeping Hardhat tests in the repository preserves a strong feedback loop for contributors and maintainers, ensuring changes are verifiable and regressions are caught early.

## Consequences

### Positive

- High confidence in contract quality: maintainers and contributors run a comprehensive test suite in-repo before publishing or submitting PRs.
- Clearer public API: no example contracts mixed with production code, reducing confusion for users and auditors.
- Slim published package and easier dependency management for consumers focused only on artifacts and types.
- Easier maintenance and reviews: tests live next to the source, enabling faster iteration and better coverage.
- Encourages external contributions with reproducible tests, without forcing consumers to install example projects.
- Better separation of concerns: examples can be versioned and curated separately, tailored for documentation and tutorials.

### Negative

- Users installing the NPM package wonâ€™t get runnable examples out-of-the-box; they must consult docs or a separate examples repo.
- Slightly higher repository footprint and maintenance effort to keep tests healthy across toolchain updates.
- Coordination overhead to keep external examples aligned with released contract versions (version skew risk).

## Decision Outcome

**Chosen option:** Keep Hardhat tests in the Repository but exclude Examples from the contracts directory.