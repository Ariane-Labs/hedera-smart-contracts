---
status: "proposed"
date: "2025-10-06"
decision-makers: Fernano Paris <fernando.paris@swirldslabs.com>, Mariusz Jasuwienas <mariusz.jasuwienas@arianelabs.com>, Michal Walczak <michal.walczak@arianelabs.com>, Piotr Swierzy <piotr.swierzy@arianelabs.com>
consulted:
informed:
---

# ADR 002: Directory Structure for System Contracts Repository

## Context and Problem Statement

The new Hedera System Contracts repository needs a consistent, readable, and scalable directory structure. The structure should make it easy for developers to find production contracts, interfaces, and their extensions while allowing for future growth.

We need to decide between a simplified flat structure versus a more granular modular split.

## Decision Drivers

- Ease of finding production contracts and interfaces
- Simplicity and reduced cognitive load for users
- Ability to grow (add new system services) without directory chaos
- Consistency with community practices (e.g., OpenZeppelin Contracts)
- Clear separation of concerns (contracts, interfaces, utilities, tests)
- Maintainability and scalability

## Considered Options

1. **Simplified Structure** (recommended)
2. Modular, Granular Structure

## Option 1: Simplified Structure

A flatter structure with fewer nested directories, making it easier to navigate and understand at a glance.

**Directory Layout:**

```
contracts/
├── account-service/
│   ├── HederaAccountService.sol
│   ├── IHederaAccountService.sol
│   ├── IHRC632.sol
│   ├── IHRC904AccountFacade.sol
│   ├── IHRC906.sol
│   └── IHRC906AccountFacade.sol
├── schedule-service/
│   ├── HederaScheduleService.sol
│   ├── IHederaScheduleService.sol
│   ├── IHRC755.sol
│   ├── IHRC755ScheduleFacade.sol
│   └── IHRC756.sol
├── token-service/
│   ├── HederaTokenService.sol
│   ├── IHederaTokenService.sol
│   ├── IHRC719.sol
│   ├── IHRC904.sol
│   ├── IHRC904TokenFacade.sol
│   ├── IHTSStructs.sol
│   ├── FeeHelper.sol
│   ├── KeyHelper.sol
│   ├── ExpiryHelper.sol
│   └── safe-hts/
├── token-service-v2/
│   ├── HederaTokenService.sol
│   ├── IHederaTokenServiceV2.sol
│   ├── FeeHelper.sol
│   ├── KeyHelper.sol
│   └── HederaResponseCodes.sol
├── prng/
│   ├── PrngSystemContract.sol
│   └── IPrngSystemContract.sol
├── common/
│   └── HederaResponseCodes.sol
└── mocks/
test/
```
What did we remove:
- contracts/system-contracts/hedera-account-service/examples
- contracts/system-contracts/hedera-schedule-service/examples
- contracts/system-contracts/hedera-token-service/examples
- contracts/system-contracts/hedera-token-service/AtomicHTS.sol
- contracts/system-contracts/hedera-token-service-v2/examples
- contracts/system-contracts/native/EcrecoverCaller.sol
- contracts/system-contracts/native/EthNativePrecompileCaller.sol
Why: these usage examples would fit better in another repository.

## Consequences

### Positive

- Simple, flat structure - easy to navigate
- Less cognitive load for developers
- Faster to locate specific contracts
- Similar to OpenZeppelin's flat structure within modules
- Fewer directories to manage
- Clear service boundaries without excessive nesting

### Negative

- Interfaces and implementations are in the same directory
- Less separation between different types of files (interfaces, helpers, implementations)
- May become cluttered if services grow significantly
- Harder to identify file types at a glance

## Option 2: Modular, Granular Structure

A more hierarchical structure with dedicated subdirectories for interfaces, utilities, and other components.

**Directory Layout:**

```
contracts/
├── interfaces/              # Top-level facades
│   ├── IHRC904AccountFacade.sol
│   ├── IHRC906AccountFacade.sol
│   ├── IHRC755ScheduleFacade.sol
│   ├── IHRC904TokenFacade.sol
│   └── IPrngSystemContract.sol
├── account-service/
│   ├── HederaAccountService.sol
│   └── interfaces/
│       ├── IHederaAccountService.sol
│       ├── IHRC632.sol
│       └── IHRC906.sol
├── schedule-service/
│   ├── HederaScheduleService.sol
│   └── interfaces/
│       ├── IHederaScheduleService.sol
│       ├── IHRC755.sol
│       └── IHRC756.sol
├── token-service/
│   ├── HederaTokenService.sol
│   ├── interfaces/
│   │   ├── IHederaTokenService.sol
│   │   ├── IHRC719.sol
│   │   └── IHTSStructs.sol
│   └── utils/
│       ├── FeeHelper.sol
│       ├── KeyHelper.sol
│       ├── ExpiryHelper.sol
│       └── safe-hts/
├── token-service-v2/
│   ├── HederaTokenService.sol
│   ├── interfaces/
│   │   └── IHederaTokenServiceV2.sol
│   └── utils/
│       ├── FeeHelper.sol
│       ├── KeyHelper.sol
│       └── HederaResponseCodes.sol
├── prng/
│   └── PrngSystemContract.sol
├── hip-719-proxy/
│   └── HRC719TokenProxy.sol
├── common/
│   └── HederaResponseCodes.sol
└── mocks/
test/
```

### Positive

- Clear separation between interfaces, implementations, and utilities
- Easy to identify file types at a glance
- Better organization for large services with many files
- Service-specific utilities are isolated
- Clearer architecture and intent

### Negative

- More complex directory structure
- More directories to navigate
- Increased cognitive load
- May be over-engineered for the current scope
- Longer import paths
- More initial setup complexity

## Decision Outcome
**Chosen option:** Simplified structure (Option 1).

### Rationale

- **Service-level organization**: Each system service (account-service, token-service, etc.) has its own directory
- **Flat within services**: Interfaces, implementations, and helpers coexist in the same service directory
- **Special directories**:
  - `common/` for shared utilities
  - `mocks/` for test mocks
  - `test/` for all tests and examples
- **Subdirectories allowed**: Services can have subdirectories (e.g., `safe-hts/`) when logically grouped functionality exists

## Consequences

### Positive

- Simple, intuitive structure
- Easy to find contracts quickly
- Lower barrier to entry for new developers
- Less cognitive overhead
- Shorter import paths
- Sufficient for current scope
- Can scale to more granular structure if needed

### Negative

- Less visual separation between interfaces and implementations
- May require discipline to prevent service directories from becoming too large
- Some duplication in naming (e.g., multiple files named FeeHelper.sol in different services)

## Decision Outcome

**Chosen option:** Simplified structure (Option 1).